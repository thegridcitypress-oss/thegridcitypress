<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Grid City Press</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
<style>
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: 'Playfair Display', serif; background:#f9f9f9; color:#111; }
header { position:relative; background:#fff; border-bottom:1px solid #ccc; padding:30px 20px 20px; }
.header-inner { text-align:center; }
header h1 { font-size:3rem; font-weight:700; letter-spacing:1px; margin:0; }
nav.main-nav { margin-top:20px; margin-bottom:30px; }
.nav-left { text-align:center; }
.nav-left a { text-decoration:none; color:#444; margin:0 15px; font-weight:600; font-size:1rem; cursor:pointer; }
.nav-left a:hover { color:#000; }
.nav-right { position:absolute; top:35px; right:20px; }
.nav-right a, .nav-right button { text-decoration:none; color:#444; margin:0 10px; font-weight:600; font-size:1rem; background:none; border:none; cursor:pointer; font-family:inherit; }
.nav-right a:hover, .nav-right button:hover { color:#000; }
.container { max-width:800px; margin:0 auto; padding:0 20px 40px; }
h2.section-title { font-size:1.8rem; margin:20px 0 15px; font-weight:700; border-bottom:1px solid #ddd; padding-bottom:10px; }
.article-link { display:block; border:1px solid #ccc; padding:20px; margin-bottom:20px; text-decoration:none; color:inherit; transition:background-color 0.2s ease; cursor:pointer; }
.article-link:hover { background-color:#f0f0f0; }
.article-link h3 { margin:0 0 5px; font-size:1.4rem; }
.article-link small { color:#777; font-size:0.9rem; }
footer { text-align:center; color:#aaa; font-size:0.8rem; padding:20px; border-top:1px solid #ddd; }
.article-view { display:none; }
.article-view.active { display:block; }
.article-content { margin-top:30px; line-height:1.8; }
.article-content p { margin-bottom:1.2em; }
.back-link { display:inline-block; margin-top:30px; text-decoration:none; color:#444; font-weight:600; cursor:pointer; }
.back-link:hover { color:#000; }
.auth-container { display:none; max-width:600px; margin:50px auto; padding:0 20px; }
.auth-container.active { display:block; }
.auth-container h1 { text-align:center; margin-bottom:30px; }
.auth-form label { display:block; margin-top:20px; font-weight:bold; }
.auth-form input, .auth-form select { width:100%; padding:10px; margin-top:5px; font-family:inherit; font-size:inherit; border:1px solid #ccc; }
.auth-form button { margin-top:20px; padding:10px 20px; background:#000; color:#fff; border:none; cursor:pointer; font-family:inherit; font-size:inherit; }
.auth-form button:hover { background:#333; }
.message { margin-top:20px; padding:10px; font-weight:bold; color:darkgreen; background:#e8f5e9; border:1px solid #4caf50; border-radius:4px; }
.message.error { color:darkred; background:#ffebee; border-color:#f44336; }
.auth-links { margin-top:20px; }
.auth-links a { color:#444; text-decoration:none; display:block; margin-top:10px; cursor:pointer; }
.hidden { display:none; }
.profile-container { display:none; max-width:600px; margin:50px auto; padding:0 20px; }
.profile-container.active { display:block; }
.profile-info { margin:20px 0; }
.profile-info p { margin:10px 0; }
.links { margin-top:30px; display:flex; flex-direction:column; gap:15px; }
.links a, .links button { text-decoration:none; background:#000; color:#fff; padding:10px 15px; font-weight:600; text-align:center; border-radius:4px; cursor:pointer; border:none; font-family:inherit; font-size:inherit; }
.links a:hover, .links button:hover { background:#333; }
#editor { border:1px solid #ccc; padding:15px; min-height:300px; background:#fff; margin-top:5px; overflow-y:auto; }
.delete-button { margin-top:10px; display:inline-block; padding:6px 12px; background:crimson; color:white; font-size:0.9rem; border-radius:4px; border:none; cursor:pointer; font-family:inherit; }
.delete-button:hover { background:darkred; }
@media(max-width:768px){header h1{font-size:2rem}.nav-right{position:static;text-align:center;margin-top:15px}.nav-left a{display:block;margin:10px 0}}
</style>
</head>
<body>
<!-- HOME -->
<div id="home-page">
<header>
<div class="header-inner"><h1>The Grid City Press</h1></div>
<nav class="main-nav">
<div class="nav-left">
<a onclick="showHome()">Home</a>
<a onclick="filterByTeam('Utah Athletics')">Utah Athletics</a>
<a onclick="filterByTeam('Utah Mammoth')">Utah Mammoth</a>
<a onclick="filterByTeam('Utah Jazz')">Utah Jazz</a>
</div>
<div class="nav-right" id="nav-auth">
<a onclick="showLogin()">Log In</a>
<a onclick="showRegister()">Register</a>
</div>
</nav>
</header>
<div class="container">
<h2 class="section-title" id="articles-title">Latest Articles</h2>
<div id="articles-list"><p>No articles yet.</p></div>
</div>
<footer>&copy; <span id="year"></span> The Grid City Press. All rights reserved.</footer>
</div>

<!-- ARTICLE VIEW -->
<div id="article-page" class="article-view">
<header><div class="header-inner"><h1>The Grid City Press</h1></div></header>
<div class="container">
<h1 id="view-article-title"></h1>
<small id="article-meta"></small>
<div class="article-content" id="article-content"></div>
<a class="back-link" onclick="showHome()">← Back to Home</a>
</div>
</div>

<!-- LOGIN -->
<div id="login-page" class="auth-container">
<h1>Log In</h1>
<div id="login-message"></div>
<form class="auth-form" onsubmit="handleLogin(event)">
<label for="login-username">Username</label>
<input type="text" id="login-username" required>
<label for="login-password">Password</label>
<input type="password" id="login-password" required>
<button type="submit">Log In</button>
</form>
<div class="auth-links">
<a onclick="showRegister()">→ Create an Account</a>
<a onclick="showHome()">← Back to Home</a>
</div>
</div>

<!-- REGISTER -->
<div id="register-page" class="auth-container">
<h1>Create Account</h1>
<div id="register-message"></div>
<form class="auth-form" onsubmit="handleRegister(event)">
<label for="reg-username">Username</label>
<input type="text" id="reg-username" required>
<label for="reg-password">Password</label>
<input type="password" id="reg-password" required>
<label for="reg-role">I am a…</label>
<select id="reg-role" required onchange="toggleAdminSecret()">
<option value="">-- Select Role --</option>
<option value="user">User</option>
<option value="admin">Admin</option>
</select>
<div id="admin-secret-container" class="hidden">
<label for="admin-secret">Admin Secret</label>
<input type="password" id="admin-secret">
</div>
<button type="submit">Register</button>
</form>
<div class="auth-links">
<a onclick="showLogin()">← Back to Log In</a>
<a onclick="showHome()">← Back to Home</a>
</div>
</div>

<!-- PROFILE -->
<div id="profile-page" class="profile-container">
<h1>Your Profile</h1>
<div class="profile-info">
<p><strong>Username:</strong> <span id="profile-username"></span></p>
<p><strong>Role:</strong> <span id="profile-role"></span></p>
</div>
<div class="links">
<button onclick="showUpdateProfile()">Update Profile</button>
<div id="admin-actions" class="hidden">
<button onclick="showAddArticle()">Add Article</button>
<button onclick="showDeleteArticles()">Delete Articles</button>
</div>
<button onclick="handleLogout()">Log Out</button>
</div>
<a class="back-link" onclick="showHome()">← Back to Home</a>
</div>

<!-- ADD ARTICLE -->
<div id="add-article-page" class="auth-container">
<h1>Publish a New Article</h1>
<div id="add-article-message"></div>
<form class="auth-form" onsubmit="handleAddArticle(event)">
<label for="new-article-title">Title</label>
<input type="text" id="new-article-title" required>
<label for="editor">Full Article</label>
<div id="editor" contenteditable="true"></div>
<label for="article-team">Team</label>
<select id="article-team" required>
<option value="">-- Choose a Team --</option>
<option value="Utah Athletics">Utah Athletics</option>
<option value="Utah Mammoth">Utah Mammoth</option>
<option value="Utah Jazz">Utah Jazz</option>
</select>
<button type="submit">Publish Article</button>
</form>
<a class="back-link" onclick="showProfile()">← Back to Profile</a>
</div>

<!-- DELETE ARTICLES -->
<div id="delete-articles-page" class="auth-container">
<h1>Delete Articles</h1>
<div id="delete-message"></div>
<div id="delete-articles-list"></div>
<a class="back-link" onclick="showProfile()">← Back to Profile</a>
</div>

<script>
let articles = [];
let users = [];
let currentUser = null;
document.getElementById('year').textContent = new Date().getFullYear();

function saveUsers(){localStorage.setItem('gridCityUsers',JSON.stringify(users))}
function loadUsers(){const s=localStorage.getItem('gridCityUsers');if(s)users=JSON.parse(s);else{users=[{username:'admin',password:'toor',role:'admin'}];saveUsers()}}
function saveArticles(){localStorage.setItem('gridCityArticles',JSON.stringify(articles))}
function loadArticles(){const s=localStorage.getItem('gridCityArticles');if(s)articles=JSON.parse(s);else{articles=[];saveArticles()}}
function loadCurrentUser(){const s=localStorage.getItem('gridCityCurrentUser');if(s)currentUser=JSON.parse(s)}
loadUsers();loadArticles();loadCurrentUser();updateAuthUI();showHome();

function updateAuthUI(){const navAuth=document.getElementById('nav-auth');if(currentUser){navAuth.innerHTML='<a onclick="showProfile()">'+escapeHtml(currentUser.username)+'</a><button onclick="handleLogout()">Log Out</button>'}else{navAuth.innerHTML='<a onclick="showLogin()">Log In</a><a onclick="showRegister()">Register</a>'}}

function hideAllPages(){document.getElementById('home-page').style.display='none';document.querySelectorAll('.article-view,.auth-container,.profile-container').forEach(el=>el.classList.remove('active'))}

function showHome(){hideAllPages();currentFilter=null;document.getElementById('home-page').style.display='block';displayArticles();window.scrollTo(0,0)}

function filterByTeam(team){currentFilter=team;hideAllPages();document.getElementById('home-page').style.display='block';displayArticles(team);window.scrollTo(0,0)}

function showArticle(id){const a=articles.find(a=>a.id===id);if(!a)return;document.getElementById('view-article-title').textContent=a.title;document.getElementById('article-meta').textContent=a.team+' | '+formatDate(a.published_at);document.getElementById('article-content').innerHTML=a.content;hideAllPages();document.getElementById('article-page').classList.add('active');window.scrollTo(0,0)}

function showLogin(){hideAllPages();document.getElementById('login-message').innerHTML='';document.getElementById('login-page').classList.add('active');window.scrollTo(0,0)}
function showRegister(){hideAllPages();document.getElementById('register-message').innerHTML='';document.getElementById('reg-username').value='';document.getElementById('reg-password').value='';document.getElementById('reg-role').value='';document.getElementById('admin-secret').value='';document.getElementById('admin-secret-container').classList.add('hidden');document.getElementById('register-page').classList.add('active');window.scrollTo(0,0)}
function showProfile(){if(!currentUser){showLogin();return}document.getElementById('profile-username').textContent=currentUser.username;document.getElementById('profile-role').textContent=currentUser.role.charAt(0).toUpperCase()+currentUser.role.slice(1);document.getElementById('admin-actions').classList.toggle('hidden',currentUser.role!=='admin');hideAllPages();document.getElementById('profile-page').classList.add('active');window.scrollTo(0,0)}
function showUpdateProfile(){if(!currentUser)return;document.getElementById('update-username').value=currentUser.username;document.getElementById('update-role').value=currentUser.role;document.getElementById('update-password').value='';document.getElementById('update-admin-secret').value='';document.getElementById('update-admin-secret-container').classList.toggle('hidden',currentUser.role!=='admin');hideAllPages();document.getElementById('update-profile-page').classList.add('active');window.scrollTo(0,0)}
function showAddArticle(){if(!currentUser||currentUser.role!=='admin')return;document.getElementById('new-article-title').value='';document.getElementById('editor').innerHTML='';document.getElementById('article-team').value='';document.getElementById('add-article-message').innerHTML='';hideAllPages();document.getElementById('add-article-page').classList.add('active');window.scrollTo(0,0)}
function showDeleteArticles(){if(!currentUser||currentUser.role!=='admin')return;const list=document.getElementById('delete-articles-list');if(articles.length===0)list.innerHTML='<p>No articles available.</p>';else{list.innerHTML=articles.slice().sort((a,b)=>new Date(b.published_at)-new Date(a.published_at)).map(a=>'<div class="article-link"><h3>'+escapeHtml(a.title)+'</h3><small>'+escapeHtml(a.team)+' | '+escapeHtml(formatDate(a.published_at))+'</small><br><button class="delete-button" onclick="confirmDeleteArticle('+a.id+')">Delete</button></div>').join('')}document.getElementById('delete-message').innerHTML='';hideAllPages();document.getElementById('delete-articles-page').classList.add('active');window.scrollTo(0,0)}
function confirmDeleteArticle(id){if(!confirm('Are you sure you want to delete this article?'))return;deleteArticle(id)}

function displayArticles(filter=null){const list=document.getElementById('articles-list');const title=document.getElementById('articles-title');let filtered=filter?articles.filter(a=>a.team===filter):articles.slice();title.textContent=filter?filter+' Articles':'Latest Articles';filtered.sort((a,b)=>new Date(b.published_at)-new Date(a.published_at));if(filtered.length===0)list.innerHTML='<p>No articles found.</p>';else{list.innerHTML=filtered.map(a=>'<a class="article-link" onclick="showArticle('+a.id+')"><h3>'+escapeHtml(a.title)+'</h3><small>'+escapeHtml(a.team)+' | '+escapeHtml(formatDate(a.published_at))+'</small></a>').join('')}}

function handleAddArticle(e){e.preventDefault();if(!currentUser||currentUser.role!=='admin'){showMessage('add-article-message','❌ Only admins can publish articles.',true);return}const title=document.getElementById('new-article-title').value.trim();const content=document.getElementById('editor').innerHTML.trim();const team=document.getElementById('article-team').value;if(!title||!content||!team){showMessage('add-article-message','❌ All fields are required.',true);return}const newArticle={id:(articles.length?Math.max(...articles.map(a=>a.id)):0)+1,title,content,team,published_at:new Date().toISOString().split('T')[0]};articles.unshift(newArticle);saveArticles();showMessage('add-article-message','✅ Article published!',false);setTimeout(()=>showProfile(),800)}

function deleteArticle(id){const idx=articles.findIndex(a=>a.id===id);if(idx>-1){articles.splice(idx,1);saveArticles();showDeleteArticles();showMessage('delete-message','✅ Article deleted successfully.',false)}}

function handleLogin(e){e.preventDefault();const u=document.getElementById('login-username').value.trim();const p=document.getElementById('login-password').value;const user=users.find(x=>x.username===u&&x.password===p);if(user){currentUser={username:user.username,role:user.role};localStorage.setItem('gridCityCurrentUser',JSON.stringify(currentUser));updateAuthUI();showHome()}else showMessage('login-message','❌ Invalid username or password.',true)}

function handleRegister(e){e.preventDefault();const u=document.getElementById('reg-username').value.trim();const p=document.getElementById('reg-password').value;const r=document.getElementById('reg-role').value;if(!u||!p||!r){showMessage('register-message','❌ All fields are required.',true);return}if(users.find(x=>x.username===u)){showMessage('register-message','❌ Username already exists.',true);return}if(r==='admin'){const secret=document.getElementById('admin-secret').value;if(secret!=='1234'){showMessage('register-message','❌ Invalid admin secret.',true);return}}users.push({username:u,password:p,role:r});saveUsers();showMessage('register-message','✅ Account created! You can log in now.',false);setTimeout(showLogin,800)}

function toggleAdminSecret(){document.getElementById('admin-secret-container').classList.toggle('hidden',document.getElementById('reg-role').value!=='admin')}

function handleLogout(){currentUser=null;localStorage.removeItem('gridCityCurrentUser');updateAuthUI();showHome()}

function formatDate(dateStr){const d=new Date(dateStr);return d.toLocaleDateString(undefined,{year:'numeric',month:'long',day:'numeric'})}

function escapeHtml(unsafe){return unsafe.replace(/[&<"'>]/g,function(m){return{'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m]})}
</script>
</body>
</html>
